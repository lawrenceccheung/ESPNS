
clear all
addpath("PNLA_MATLAB_OCTAVE");
addpath("SuiteSparse/SPQR/MATLAB");
stol=2.5E-15;
nu = 1.000000;
uexact = [ 0.0000000000+0.083333333333333329j, 0.0000000000+0.083333333333333329j, 0.0000000000-0.083333333333333329j, 0.0000000000-0.083333333333333329j, 0.0000000000+0.055555555555555552j, 0.0000000000+0.055555555555555552j, 0.0000000000-0.055555555555555552j, 0.0000000000-0.055555555555555552j, 0.0000000000+0.037037037037037035j, 0.0000000000+0.037037037037037035j, 0.0000000000-0.037037037037037035j, 0.0000000000-0.037037037037037035j, 0.0000000000-0.083333333333333329j, 0.0000000000+0.083333333333333329j, 0.0000000000-0.083333333333333329j, 0.0000000000+0.083333333333333329j, 0.0000000000-0.055555555555555552j, 0.0000000000+0.055555555555555552j, 0.0000000000-0.055555555555555552j, 0.0000000000+0.055555555555555552j, 0.0000000000-0.037037037037037035j, 0.0000000000+0.037037037037037035j, 0.0000000000-0.037037037037037035j, 0.0000000000+0.037037037037037035j, ];
polysys{1,1} = [ -0.000000-0.250000j 3.000000 ];
polysys{2,1} = [ -0.000000-0.250000j 3.000000 ];
polysys{3,1} = [ -0.000000+0.250000j 3.000000 ];
polysys{4,1} = [ -0.000000+0.250000j 3.000000 ];
polysys{5,1} = [ -0.000000-0.250000j 1.000000 3.000000 ];
polysys{6,1} = [ -0.000000-0.250000j 1.000000 3.000000 ];
polysys{7,1} = [ -0.000000+0.250000j 1.000000 3.000000 ];
polysys{8,1} = [ -0.000000+0.250000j 1.000000 3.000000 ];
polysys{9,1} = [ -0.000000-0.250000j 1.000000 1.000000 3.000000 ];
polysys{10,1} = [ -0.000000-0.250000j 1.000000 1.000000 3.000000 ];
polysys{11,1} = [ -0.000000+0.250000j 1.000000 1.000000 3.000000 ];
polysys{12,1} = [ -0.000000+0.250000j 1.000000 1.000000 3.000000 ];
polysys{13,1} = [ -0.000000+0.250000j 3.000000 ];
polysys{14,1} = [ -0.000000-0.250000j 3.000000 ];
polysys{15,1} = [ -0.000000+0.250000j 3.000000 ];
polysys{16,1} = [ -0.000000-0.250000j 3.000000 ];
polysys{17,1} = [ -0.000000+0.250000j 1.000000 3.000000 ];
polysys{18,1} = [ -0.000000-0.250000j 1.000000 3.000000 ];
polysys{19,1} = [ -0.000000+0.250000j 1.000000 3.000000 ];
polysys{20,1} = [ -0.000000-0.250000j 1.000000 3.000000 ];
polysys{21,1} = [ -0.000000+0.250000j 1.000000 1.000000 3.000000 ];
polysys{22,1} = [ -0.000000-0.250000j 1.000000 1.000000 3.000000 ];
polysys{23,1} = [ -0.000000+0.250000j 1.000000 1.000000 3.000000 ];
polysys{24,1} = [ -0.000000-0.250000j 1.000000 1.000000 3.000000 ];

% kindex map
kindex = [0 0 -1 -1;
0 0 -1 1;
0 0 1 -1;
0 0 1 1;
0 1 -1 -1;
0 1 -1 1;
0 1 1 -1;
0 1 1 1;
0 2 -1 -1;
0 2 -1 1;
0 2 1 -1;
0 2 1 1;
1 0 -1 -1;
1 0 -1 1;
1 0 1 -1;
1 0 1 1;
1 1 -1 -1;
1 1 -1 1;
1 1 1 -1;
1 1 1 1;
1 2 -1 -1;
1 2 -1 1;
1 2 1 -1;
1 2 1 1;
];
polysys{1,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{2,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{3,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{4,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{5,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{6,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{7,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{8,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{9,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{10,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{11,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{12,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0];
polysys{13,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0];
polysys{14,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0];
polysys{15,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0];
polysys{16,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0];
polysys{17,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0];
polysys{18,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0];
polysys{19,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0];
polysys{20,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0];
polysys{21,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0];
polysys{22,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0];
polysys{23,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0];
polysys{24,2} = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1];

[root, d, c, ns, check, cr, digits] = qdsparf2(polysys, stol);
disp(sprintf('diff = %e',norm(uexact-root)))

%Print the solution in pretty form
screenstring='%2i % 2i % 2i % 2i % 9.7fi %i*i/%i\n';
latexstring='$%i$ & $%i$ &  $%i$ & $%i$ & $\\texttt{% .7f}\\ii$ & ${%i\\ii}/{%i}$~\\tabularnewline\n';
for i=1:length(kindex),
    idim = kindex(i,1);
    k0   = kindex(i,2);
    k1   = kindex(i,3);
    k2   = kindex(i,4);
    fprintf(latexstring,...
            idim+1, kindex(i,2), k1, k2,...
            imag(full(root(i))), (-1)^(idim+1)*kindex(i,3+idim)*(2.0*nu)^k0, 4*(1+2*nu)^(k0+1));
end
